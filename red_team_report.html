
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF--8">
            <title>Red Team Security Report</title>
            <style>
                body { font-family: sans-serif; }
                h1, h2 { color: #333; }
                .finding { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; }
                .CRITICAL { border-left: 5px solid red; }
                .HIGH { border-left: 5px solid orange; }
                .MEDIUM { border-left: 5px solid yellow; }
                .LOW { border-left: 5px solid lightblue; }
            </style>
        </head>
        <body>
            <h1>Red Team Security Report for .</h1>
            <h2>Summary</h2>
            <p>Total Findings: 16</p>
            <ul>
                <li>Critical: 9</li>
                <li>High: 2</li>
                <li>Medium: 1</li>
                <li>Low: 4</li>
            </ul>
            <h2>Detailed Findings</h2>

            <div class="finding CRITICAL">
                <h3>[CRITICAL] Vulnerability: broken_auth</h3>
                <p><strong>Category:</strong> api_security</p>
                <p><strong>Component:</strong> GET /api/users/2</p>
                <p><strong>Description:</strong> Authentication bypass: 7 bypasses found</p>
                <p><strong>Evidence:</strong> <pre><code>['No authentication required', 'Empty token accepted', 'Invalid token accepted: Bearer invalid', 'Invalid token accepted: Bearer null', 'Invalid token accepted: Bearer undefined', 'Invalid token accepted: Basic admin:admin', 'Invalid token accepted: Bearer eyJhbGciOiJub25lIn0.eyJzdWIiOiJhZG1pbiJ9.']</code></pre></p>
                <p><strong>Remediation:</strong> Implement strong authentication. Validate tokens properly. Use secure JWT algorithms.</p>
            </div>

            <div class="finding CRITICAL">
                <h3>[CRITICAL] Vulnerability: broken_function_auth</h3>
                <p><strong>Category:</strong> api_security</p>
                <p><strong>Component:</strong> GET /api/users/2</p>
                <p><strong>Description:</strong> Function auth: 4 unauthorized function accesses</p>
                <p><strong>Evidence:</strong> <pre><code>['POST /api/users/2', 'PUT /api/users/2', 'DELETE /api/users/2', 'PATCH /api/users/2']</code></pre></p>
                <p><strong>Remediation:</strong> Implement role-based access control. Verify permissions on every request.</p>
            </div>

            <div class="finding CRITICAL">
                <h3>[CRITICAL] Vulnerability: injection</h3>
                <p><strong>Category:</strong> api_security</p>
                <p><strong>Component:</strong> GET /api/users/2</p>
                <p><strong>Description:</strong> Injection: 14 potential injection points</p>
                <p><strong>Evidence:</strong> <pre><code>["sql: ' OR '1'='1", "sql: '; DROP TABLE users--", "sql: 1' UNION SELECT * FROM users--", "nosql: {'$gt': ''}", "nosql: {'$ne': null}", 'nosql: [$ne]=null', 'command: ; ls -la', 'command: | cat /etc/passwd', 'command: && whoami', 'ldap: *', 'ldap: admin*', 'ldap: *)(uid=*))(|(uid=*', "xpath: ' or '1'='1", "xpath: ' or 1=1 or ''='"]</code></pre></p>
                <p><strong>Remediation:</strong> Use parameterized queries. Validate and sanitize all inputs. Use ORMs.</p>
            </div>

            <div class="finding CRITICAL">
                <h3>[CRITICAL] Vulnerability: broken_auth</h3>
                <p><strong>Category:</strong> api_security</p>
                <p><strong>Component:</strong> GET /api/admin/users</p>
                <p><strong>Description:</strong> Authentication bypass: 7 bypasses found</p>
                <p><strong>Evidence:</strong> <pre><code>['No authentication required', 'Empty token accepted', 'Invalid token accepted: Bearer invalid', 'Invalid token accepted: Bearer null', 'Invalid token accepted: Bearer undefined', 'Invalid token accepted: Basic admin:admin', 'Invalid token accepted: Bearer eyJhbGciOiJub25lIn0.eyJzdWIiOiJhZG1pbiJ9.']</code></pre></p>
                <p><strong>Remediation:</strong> Implement strong authentication. Validate tokens properly. Use secure JWT algorithms.</p>
            </div>

            <div class="finding CRITICAL">
                <h3>[CRITICAL] Vulnerability: broken_function_auth</h3>
                <p><strong>Category:</strong> api_security</p>
                <p><strong>Component:</strong> GET /api/admin/users</p>
                <p><strong>Description:</strong> Function auth: 4 unauthorized function accesses</p>
                <p><strong>Evidence:</strong> <pre><code>['POST /api/admin/users', 'PUT /api/admin/users', 'DELETE /api/admin/users', 'PATCH /api/admin/users']</code></pre></p>
                <p><strong>Remediation:</strong> Implement role-based access control. Verify permissions on every request.</p>
            </div>

            <div class="finding CRITICAL">
                <h3>[CRITICAL] Vulnerability: injection</h3>
                <p><strong>Category:</strong> api_security</p>
                <p><strong>Component:</strong> GET /api/admin/users</p>
                <p><strong>Description:</strong> Injection: 14 potential injection points</p>
                <p><strong>Evidence:</strong> <pre><code>["sql: ' OR '1'='1", "sql: '; DROP TABLE users--", "sql: 1' UNION SELECT * FROM users--", "nosql: {'$gt': ''}", "nosql: {'$ne': null}", 'nosql: [$ne]=null', 'command: ; ls -la', 'command: | cat /etc/passwd', 'command: && whoami', 'ldap: *', 'ldap: admin*', 'ldap: *)(uid=*))(|(uid=*', "xpath: ' or '1'='1", "xpath: ' or 1=1 or ''='"]</code></pre></p>
                <p><strong>Remediation:</strong> Use parameterized queries. Validate and sanitize all inputs. Use ORMs.</p>
            </div>

            <div class="finding HIGH">
                <h3>[HIGH] Race Condition in Withdrawal API (Double Spend)</h3>
                <p><strong>Category:</strong> race_conditions</p>
                <p><strong>Component:</strong> POST /api/payments/withdraw</p>
                <p><strong>Description:</strong> Concurrent requests to the withdrawal API resulted in multiple outcomes, indicating a race condition. This could allow for 'double spending'. Details: Detected 48 unique outcomes during concurrent execution.</p>
                <p><strong>Evidence:</strong> <pre><code>48 unique outcomes observed.</code></pre></p>
                <p><strong>Remediation:</strong> Implement a pessimistic lock (e.g., a mutex or database-level lock) around the balance check and withdrawal operation.</p>
            </div>

            <div class="finding CRITICAL">
                <h3>[CRITICAL] Sql Injection in secure_database.py</h3>
                <p><strong>Category:</strong> static_analysis</p>
                <p><strong>Component:</strong> ./secure_database.py:308</p>
                <p><strong>Description:</strong> SQL query uses a variable tainted by an f-string</p>
                <p><strong>Evidence:</strong> <pre><code>cursor.execute(query, (f"%{search_term}%",))</code></pre></p>
                <p><strong>Remediation:</strong> Use parameterized queries instead</p>
            </div>

            <div class="finding MEDIUM">
                <h3>[MEDIUM] Weak Cryptography in red_team_fuzzer.py</h3>
                <p><strong>Category:</strong> static_analysis</p>
                <p><strong>Component:</strong> ./src/global_red_team/red_team_fuzzer.py:322</p>
                <p><strong>Description:</strong> Weak cryptographic algorithms are vulnerable to attacks</p>
                <p><strong>Evidence:</strong> <pre><code>if interesting and self.mutator.secure_random.random() < 0.7:</code></pre></p>
                <p><strong>Remediation:</strong> Use SHA-256 or better. Use secrets module for random values.</p>
            </div>

            <div class="finding CRITICAL">
                <h3>[CRITICAL] Jwt Alg None in red_team_api_tester.py</h3>
                <p><strong>Category:</strong> static_analysis</p>
                <p><strong>Component:</strong> ./src/global_red_team/red_team_api_tester.py:215</p>
                <p><strong>Description:</strong> JWT decoding without an explicit 'algorithms' parameter is vulnerable to 'alg=none' attacks.</p>
                <p><strong>Evidence:</strong> <pre><code>decoded = jwt.decode(</code></pre></p>
                <p><strong>Remediation:</strong> Always specify the expected list of algorithms, e.g., algorithms=['HS256'].</p>
            </div>

            <div class="finding CRITICAL">
                <h3>[CRITICAL] Sql Injection in database.py</h3>
                <p><strong>Category:</strong> static_analysis</p>
                <p><strong>Component:</strong> ./src/global_red_team/database.py:308</p>
                <p><strong>Description:</strong> SQL query uses a variable tainted by an f-string</p>
                <p><strong>Evidence:</strong> <pre><code>cursor.execute(query, (f"%{search_term}%",))</code></pre></p>
                <p><strong>Remediation:</strong> Use parameterized queries instead</p>
            </div>

            <div class="finding LOW">
                <h3>[LOW] Hardcoded Secrets in app.py</h3>
                <p><strong>Category:</strong> static_analysis</p>
                <p><strong>Component:</strong> ./vulnerable_app/app.py:9</p>
                <p><strong>Description:</strong> Hardcoded secrets can be extracted from source code</p>
                <p><strong>Evidence:</strong> <pre><code>app.config["SECRET_KEY"] = "your-secret-key"</code></pre></p>
                <p><strong>Remediation:</strong> Use environment variables or secrets management systems.</p>
            </div>

            <div class="finding LOW">
                <h3>[LOW] Hardcoded Secrets in test_orchestrator.py</h3>
                <p><strong>Category:</strong> static_analysis</p>
                <p><strong>Component:</strong> ./tests/test_orchestrator.py:10</p>
                <p><strong>Description:</strong> Hardcoded secrets can be extracted from source code</p>
                <p><strong>Evidence:</strong> <pre><code>return Settings(auth_token="a_valid_token_that_is_long_enough")</code></pre></p>
                <p><strong>Remediation:</strong> Use environment variables or secrets management systems.</p>
            </div>

            <div class="finding LOW">
                <h3>[LOW] Hardcoded Secrets in test_threat_intelligence.py</h3>
                <p><strong>Category:</strong> static_analysis</p>
                <p><strong>Component:</strong> ./tests/test_threat_intelligence.py:11</p>
                <p><strong>Description:</strong> Hardcoded secrets can be extracted from source code</p>
                <p><strong>Evidence:</strong> <pre><code>return Settings(auth_token="a_valid_token_that_is_long_enough")</code></pre></p>
                <p><strong>Remediation:</strong> Use environment variables or secrets management systems.</p>
            </div>

            <div class="finding HIGH">
                <h3>[HIGH] Cross Site Scripting in test_ai_vulnerability_discovery.py</h3>
                <p><strong>Category:</strong> static_analysis</p>
                <p><strong>Component:</strong> ./tests/test_ai_vulnerability_discovery.py:41</p>
                <p><strong>Description:</strong> Security vulnerability detected</p>
                <p><strong>Evidence:</strong> <pre><code>return Markup(f"<h1>Search results for: {query}</h1>")</code></pre></p>
                <p><strong>Remediation:</strong> Follow security best practices</p>
            </div>

            <div class="finding LOW">
                <h3>[LOW] Hardcoded Secrets in test_sast_integration.py</h3>
                <p><strong>Category:</strong> static_analysis</p>
                <p><strong>Component:</strong> ./tests/test_sast_integration.py:11</p>
                <p><strong>Description:</strong> Hardcoded secrets can be extracted from source code</p>
                <p><strong>Evidence:</strong> <pre><code>settings = Settings(target_system="./vulnerable_app", auth_token="a_valid_token_that_is_long_enough")</code></pre></p>
                <p><strong>Remediation:</strong> Use environment variables or secrets management systems.</p>
            </div>

        </body>
        </html>
